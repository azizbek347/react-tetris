(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{24:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var r,a,o,i,s,c,l,u=n(0),p=n.n(u),d=n(5),h=(n(24),n(3)),f=n(19),y=n(4),b={0:{shape:[[0]],color:"255,255,255"},I:{shape:[[0,"I",0,0],[0,"I",0,0],[0,"I",0,0],[0,"I",0,0]],color:"97,237,205"},J:{shape:[[0,"J",0],[0,"J",0],["J","J",0]],color:"8,107,255"},L:{shape:[[0,"L",0],[0,"L",0],[0,"L","L"]],color:"255,155,33"},O:{shape:[["O","O"],["O","O"]],color:"00,15,255"},S:{shape:[[0,"S","S"],["S","S",0],[0,0,0]],color:"99,228,64"},T:{shape:[[0,0,0],["T","T","T"],[0,"T",0]],color:"208,126,255"},Z:{shape:[["Z","Z",0],[0,"Z","Z"],[0,0,0]],color:"255,77,103"}},m=n(2),g=y.a.div(r||(r=Object(h.a)(["\n  width: auto;\n  border: 1px solid #000;\n  background-color: rgb(",");\n"])),(function(e){return e.color})),j=function(e){var t=e.type;return Object(m.jsx)(g,{color:b[t].color})},v=Object(u.memo)(j),x=y.a.div(a||(a=Object(h.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.75);\n  display: grid;\n  place-items: center;\n"]))),O=y.a.div(o||(o=Object(h.a)(["\n  text-align: center;\n"]))),w=y.a.button(i||(i=Object(h.a)(["\n  border-radius: .5em;\n  border: none;\n  padding: 1em;\n  font-size: 1.2em;\n  background-color: #917B64;\n  color: #ffffff;\n  cursor: pointer;\n  &:focus {\n    outline: none;\n  }\n"]))),I=y.a.p(s||(s=Object(h.a)(["\n  font-size: 3em;\n  color: #FF4D69;\n  margin: 0 0 1em;\n  white-space: nowrap;\n  @media (min-width: 1170px) {\n    font-size: 4em;\n  }\n"]))),P=function(e){var t=e.startGame;return Object(m.jsx)(x,{children:Object(m.jsxs)(O,{children:[Object(m.jsx)(I,{children:"\u041a\u043e\u043d\u0435\u0446 \u0438\u0433\u0440\u044b!!!"}),Object(m.jsx)(w,{onClick:t,children:"\u0415\u0449\u0435?"})]})})},k=y.a.div(c||(c=Object(h.a)(["\n  display: grid;\n  grid-template-rows: repeat(",", calc(40vh / ","));\n  grid-template-columns: repeat(",", 1fr);\n  grid-gap: 2px;\n  padding: 2px;\n  border: 1px solid #333;\n  max-width: 320px;\n  min-width: 320px;\n  width: 100%;\n  position: relative;\n  @media (min-width: 768px) {\n    max-width: 400px;\n  }\n  @media (min-width: 1170px) {\n    max-width: 480px;\n  }\n"])),(function(e){return e.height}),(function(e){return e.width}),(function(e){return e.width})),T=function(e){var t=e.stage,n=e.isPlaying,r=e.startGame;return Object(m.jsxs)(k,{height:t.length,width:t[0].length,children:[t.map((function(e,t){return e.map((function(e,n){return Object(m.jsx)(v,{type:e[0]},"".concat(t," ").concat(n))}))})),!n&&Object(m.jsx)(P,{startGame:r})]})},G=n(16),D=n.n(G),S=y.a.div(l||(l=Object(h.a)(["\n  outline: none;\n  min-height: 100vh;\n  display: grid;\n  place-items: center;\n"]))),A=Object(f.a)((function(e){var t=e.store,n=t.stage,r=t.movePlayer,a=t.playerRotate,o=t.drop,i=t.startGame,s=t.isPlaying,c=Object(u.useRef)(),l=Object(u.useMemo)((function(){return D()((function(e){switch(e.code){case"ArrowRight":r(1);break;case"ArrowLeft":r(-1);break;case"ArrowUp":a(1);break;case"ArrowDown":o();break;default:return}}),200)}),[a,r,o]);return Object(u.useEffect)((function(){return function(){return l.cancel()}}),[l]),Object(u.useEffect)((function(){return c.current.focus()}),[s]),Object(m.jsx)(S,{tabIndex:"0",onKeyDown:l,ref:c,children:Object(m.jsx)(T,{stage:n,isPlaying:s,startGame:i})})})),H=n(10),M=n(17),E=n(18),J=n(1),R=function(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n);return e},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new WeakMap;if("object"===typeof e){var n=Array.isArray(e),r=n?[]:{};return t.get(e)?t.get(e):(t.set(e,r),n?R(e,(function(e,t){return r[t]=e})):R(Object.keys(e),(function(t){return r[t]=e[t]})),r)}return e},Z=n(9),W=function(e,t){return Object(Z.a)(Array(e)).map((function(){return Object(Z.a)(Array(t)).map((function(){return[0,"clear"]}))}))},z=function(e,t,n){for(var r=n.x,a=n.y,o=0;o<e.tetromino.length;o++)for(var i=0;i<e.tetromino[o].length;i++)if(0!==e.tetromino[o][i]&&(!t[o+e.pos.y+a]||!t[o+e.pos.y+a][i+e.pos.x+r]||"clear"!==t[o+e.pos.y+a][i+e.pos.x+r][1]))return!0},N=function(e,t){var n=e.map((function(t,n){return e.map((function(e){return e[n]}))}));return t>0?n.map((function(e){return e.reverse()})):n.reverse()},B=function(){function e(){Object(M.a)(this,e),this.stage=W(e.HEIGHT,e.WIDTH),this.isPlaying=!0,this.intervalID=null,this.player={pos:{x:0,y:-1},tetromino:b[0].shape,collided:!1},Object(J.m)(this,{stage:J.n,isPlaying:J.n,intervalID:J.n,player:J.n,startGame:J.f.bound,movePlayer:J.f.bound,updatePlayerPos:J.f.bound,resetPlayer:J.f.bound,drop:J.f.bound,updateStage:J.f.bound,playerRotate:J.f.bound,sweepRows:J.f.bound}),this.startGame()}return Object(E.a)(e,[{key:"startGame",value:function(){this.stage=W(e.HEIGHT,e.WIDTH),this.resetPlayer(),this.intervalID=setInterval(this.drop,e.TIMING),this.isPlaying=!0}},{key:"movePlayer",value:function(e){z(this.player,this.stage,{x:e,y:0})||this.updatePlayerPos({x:e,y:0})}},{key:"updatePlayerPos",value:function(e){var t=e.x,n=e.y,r=e.collided;this.player=Object(H.a)(Object(H.a)({},this.player),{},{pos:{x:this.player.pos.x+t,y:this.player.pos.y+n},collided:r}),this.updateStage()}},{key:"resetPlayer",value:function(){var t=N(function(){var e="IJLOSTZ",t=e[Math.floor(Math.random()*e.length)];return b[t]}().shape,Math.random()>.5?1:-1),n=Math.floor((e.WIDTH-t.length)/2);this.player={pos:{x:n,y:-1},tetromino:t,collided:!1}}},{key:"drop",value:function(){z(this.player,this.stage,{x:0,y:1})?this.player.pos.y<1?(clearInterval(this.intervalID),this.isPlaying=!1):this.updatePlayerPos({x:0,y:0,collided:!0}):this.updatePlayerPos({x:0,y:1,collided:!1})}},{key:"updateStage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stage,n=t.map((function(e){return e.map((function(e){return"clear"===e[1]?[0,"clear"]:e}))}));this.player.tetromino.forEach((function(t,r){t.forEach((function(t,a){0!==t&&(n[r+e.player.pos.y][a+e.player.pos.x]=[t,"".concat(e.player.collided?"merged":"clear")])}))})),this.stage=n,this.player.collided&&(this.resetPlayer(),this.sweepRows(n))}},{key:"playerRotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stage,n=L(this.player);n.tetromino=N(n.tetromino,e);for(var r=1;z(n,t,{x:0,y:0});)if(n.pos.x+=r,(r=-(r+(r>0?1:-1)))>n.tetromino[0].length)return;this.player=n,this.updateStage()}},{key:"sweepRows",value:function(e){var t=e.reduce((function(t,n){return-1===n.findIndex((function(e){return 0===e[0]}))?(t.unshift(new Array(e[0].length).fill([0,"clear"])),t):(t.push(n),t)}),[]);this.stage=t}}]),e}();B.HEIGHT=20,B.WIDTH=10,B.TIMING=1e3;var F=new B;var C=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(A,{store:F})})};Object(d.render)(Object(m.jsx)(p.a.StrictMode,{children:Object(m.jsx)(C,{})}),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.3458042e.chunk.js.map